-- Создание таблицы для плоской структуры статистики матчей
-- Используется обычная таблица + INSERT с чтением из S3

CREATE TABLE IF NOT EXISTS raw.match_stats (
    -- Основные поля матча
    match_id String,
    match_date Date,
    team_id String,
    is_home UInt8,
    
    -- Summary статистика
    summary_minutes String,
    summary_goals String,
    summary_assists String,
    summary_pens_made String,
    summary_pens_att String,
    summary_shots String,
    summary_shots_on_target String,
    summary_cards_yellow String,
    summary_cards_red String,
    summary_touches String,
    summary_tackles String,
    summary_interceptions String,
    summary_blocks String,
    summary_xg String,
    summary_npxg String,
    summary_xg_assist String,
    summary_sca String,
    summary_gca String,
    summary_passes_completed String,
    summary_passes String,
    summary_passes_pct String,
    summary_progressive_passes String,
    summary_carries String,
    summary_progressive_carries String,
    summary_take_ons String,
    summary_take_ons_won String,
    
    -- Passing статистика
    passing_minutes String,
    passing_passes_completed String,
    passing_passes String,
    passing_passes_pct String,
    passing_passes_total_distance String,
    passing_passes_progressive_distance String,
    passing_passes_completed_short String,
    passing_passes_short String,
    passing_passes_pct_short String,
    passing_passes_completed_medium String,
    passing_passes_medium String,
    passing_passes_pct_medium String,
    passing_passes_completed_long String,
    passing_passes_long String,
    passing_passes_pct_long String,
    passing_assists String,
    passing_xg_assist String,
    passing_pass_xa String,
    passing_assisted_shots String,
    passing_passes_into_final_third String,
    passing_passes_into_penalty_area String,
    passing_crosses_into_penalty_area String,
    passing_progressive_passes String,
    
    -- Pass Types статистика
    pass_types_minutes String,
    pass_types_passes String,
    pass_types_passes_live String,
    pass_types_passes_dead String,
    pass_types_passes_free_kicks String,
    pass_types_through_balls String,
    pass_types_passes_switches String,
    pass_types_crosses String,
    pass_types_throw_ins String,
    pass_types_corner_kicks String,
    pass_types_corner_kicks_in String,
    pass_types_corner_kicks_out String,
    pass_types_corner_kicks_straight String,
    pass_types_passes_completed String,
    pass_types_passes_offsides String,
    pass_types_passes_blocked String,
    
    -- Defensive Actions статистика
    defensive_actions_minutes String,
    defensive_actions_tackles String,
    defensive_actions_tackles_won String,
    defensive_actions_tackles_def_3rd String,
    defensive_actions_tackles_mid_3rd String,
    defensive_actions_tackles_att_3rd String,
    defensive_actions_challenge_tackles String,
    defensive_actions_challenges String,
    defensive_actions_challenge_tackles_pct String,
    defensive_actions_challenges_lost String,
    defensive_actions_blocks String,
    defensive_actions_blocked_shots String,
    defensive_actions_blocked_passes String,
    defensive_actions_interceptions String,
    defensive_actions_tackles_interceptions String,
    defensive_actions_clearances String,
    defensive_actions_errors String,
    
    -- Possession статистика
    possession_minutes String,
    possession_touches String,
    possession_touches_def_pen_area String,
    possession_touches_def_3rd String,
    possession_touches_mid_3rd String,
    possession_touches_att_3rd String,
    possession_touches_att_pen_area String,
    possession_touches_live_ball String,
    possession_take_ons String,
    possession_take_ons_won String,
    possession_take_ons_won_pct String,
    possession_take_ons_tackled String,
    possession_take_ons_tackled_pct String,
    possession_carries String,
    possession_carries_distance String,
    possession_carries_progressive_distance String,
    possession_progressive_carries String,
    possession_carries_into_final_third String,
    possession_carries_into_penalty_area String,
    possession_miscontrols String,
    possession_dispossessed String,
    possession_passes_received String,
    possession_progressive_passes_received String,
    
    -- Miscellaneous статистика
    miscellaneous_minutes String,
    miscellaneous_cards_yellow String,
    miscellaneous_cards_red String,
    miscellaneous_cards_yellow_red String,
    miscellaneous_fouls String,
    miscellaneous_fouled String,
    miscellaneous_offsides String,
    miscellaneous_crosses String,
    miscellaneous_interceptions String,
    miscellaneous_tackles_won String,
    miscellaneous_pens_won String,
    miscellaneous_pens_conceded String,
    miscellaneous_own_goals String,
    miscellaneous_ball_recoveries String,
    miscellaneous_aerials_won String,
    miscellaneous_aerials_lost String,
    miscellaneous_aerials_won_pct String,
    
    -- Goalkeeping статистика
    goalkeeping_nationality String,
    goalkeeping_age String,
    goalkeeping_minutes String,
    goalkeeping_gk_shots_on_target_against String,
    goalkeeping_gk_goals_against String,
    goalkeeping_gk_saves String,
    goalkeeping_gk_save_pct String,
    goalkeeping_gk_psxg String,
    goalkeeping_gk_passes_launched String,
    goalkeeping_gk_passes String,
    goalkeeping_gk_passes_throws String,
    goalkeeping_gk_pct_passes_launched String,
    goalkeeping_gk_passes_length_avg String,
    goalkeeping_gk_goal_kicks String,
    goalkeeping_gk_pct_goal_kicks_launched String,
    goalkeeping_gk_goal_kick_length_avg String,
    goalkeeping_gk_crosses String,
    goalkeeping_gk_crosses_stopped String,
    goalkeeping_gk_crosses_stopped_pct String,
    goalkeeping_gk_def_actions_outside_pen_area String,
    goalkeeping_gk_avg_distance_def_actions String,
    goalkeeping_gk_passes_completed_launched String,
    goalkeeping_gk_passes_pct_launched String
)
ENGINE = MergeTree()
ORDER BY (match_id, team_id);